#!/usr/bin/env bash
export LDAP_IMAGE=${LDAP_IMAGE:="dinkel/openldap"}
export LDAP_IMAGE_VERSION=${LDAP_IMAGE_VERSION:="2.4.40"}
export LDAP_ROOT=${LDAP_ROOT:="/var/lib/dokku/services/ldap"}

export PLUGIN_COMMAND_PREFIX="ldap"
export PLUGIN_DATA_ROOT=$LDAP_ROOT
export PLUGIN_DATASTORE_PORTS=(389)
export PLUGIN_DATASTORE_WAIT_PORT=389
export PLUGIN_DEFAULT_ALIAS="DIRECTORY"
export PLUGIN_ALT_ALIAS="DOKKU_LDAP"
export PLUGIN_IMAGE=$LDAP_IMAGE
export PLUGIN_IMAGE_VERSION=$LDAP_IMAGE_VERSION
export PLUGIN_SCHEME="ldap"
export PLUGIN_SERVICE="LDAP"
export PLUGIN_BASE_PATH="$PLUGIN_PATH"
if [[ -n $DOKKU_API_VERSION ]]; then
  export PLUGIN_BASE_PATH="$PLUGIN_ENABLED_PATH"
fi

if [[ -d "$PLUGIN_DATA_ROOT/*" ]]; then
  rm -rf "${PLUGIN_DATA_ROOT:?}/*"
fi
